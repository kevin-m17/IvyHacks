<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"> 

    <link rel="stylesheet" href="style.css">

    <title>Covid Collaboration</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Lora:400,700|Montserrat:300" rel="stylesheet">
    <script src="https://kit.fontawesome.com/a84da40d8a.js" crossorigin="anonymous"></script>

    <style>
        .bg-dark {
            background: transparent !important;
            transition: 0.5s ease;
        }

        .bg-dark.scrolled {
            background: #f5f5f4 !important;
            transition: 0.5s ease;
        }

        .bg-img {
            background-image: url("realcollab.jpeg");
            height:700px;
            width: 100%;
            -webkit-background-size: 100% auto;
            -moz-background-size: 100% auto;
            -ms-background-size: 100% auto;
            background-size: 100% auto;
            -o-background-size: 100% auto;
        }

        /* .nav-link.scrolled {
            background: #e98708 !important;
        } */

        .bg-primary {
            background: #f9f9ff !important;
        }

        .btn:hover {
            cursor: pointer;
            background-color: white;
            color: black !important;
            visibility: visible;
        }

        .card-title {
            font-size: 32px;
            font-weight: bold;
            padding: 10px;
        }

        .btn-success:hover {
            cursor: pointer;
        }
        /* .w-100 {
            width: 70%;
            height: 70%;
        } */

        /* timer */
        .outside {
            padding-bottom: 300px;
        }

        .main {
            background:brown;
            width:400px;
            height: 180px;
            margin: 100px auto;
            padding:40px;
        }

        .timer {
            background: gray;
            font-size: 50px;
            text-align:center; 
        }

        #startButton {
            position: relative;
            background: black;
            color: yellow;
            top:5px;
            padding:15px;
        }

        #endButton {
            position: relative;
            background: black;
            color: yellow;
            top:5px;
            padding:15px;
            width: 20%;
            left: 181px;
        }

/* Styling for an info pane that slides out from the left. 
    * Hidden by default. */
    #panel {
      height: 100% !important;
      width: null !important;
      background-color: white !important;
      position: fixed !important;
      z-index: 1 !important;
      overflow-x: hidden !important;
      transition: all .2s ease-out !important;
    }

    .open {
      width: 250px !important;
    }

    .hero {
      width: 100% !important;
      height: auto !important;
      max-height: 166px !important;
      display: block !important;
    }

    .place,
    p {
      font-family: 'open sans', arial, sans-serif;
      padding-left: 18px;
      padding-right: 18px;
    }

    .details {
      color: darkslategrey;
    }

    a {
      text-decoration: none;
      color: cadetblue;
    }
        
    </style>
  </head>
  <body data-spy="scroll" data-target=".navbar" data-offset="110">

        <div class="topSection">
            <nav class="navbar navbar-expand-lg navbar-light bg-dark fixed-top" id="theTopBar">
                <a class="navbar-brand" href="#">
                    <div id="logo">
                        CovidCollaboration
                    </div>
                </a>
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a href="#home" class="nav-link active">
                            Home
                        </a>
                    </li>

                    <li class="nav-item">
                        <a href="#about" class="nav-link">About</a>
                    </li>

                    <li class="nav-item">
                        <a href="#facilities" class="nav-link">
                            Nearby Facilities
                        </a>
                        <!-- <div class="dropdown-menu">
                            <a class="dropdown-item" href="#">Rubix Cube</a>
                            <a class="dropdown-item" href="timer.html">Pomodoro Timer</a>
                        </div> -->
                    </li>

                    <li class="nav-item">
                        <a href="#chat" class="nav-link">Chat</a>
                    </li>

                    <li class="nav-item">
                        <a href="#travel" class="scrollto nav-link">Our Forum</a>
                    </li>

                    <li class="nav-item">
                        <a data-smooth="#contact" href="#contact" class="scrollto nav-link">Further Resources</a>
                    </li>
                </ul>
            </nav>
        </div>

        <div id="home">
            <div class = "bg-img">
                <div class="centerText">
                    Welcome! We are here to help.
                    <br> 
                    <a href="#chat" class="btn btn-transparent text-white rounded-0" id = "frontButton">Get Assistance</a>
                </div>
            </div>
        </div>

        <div id="about">
            <div class="card bg-primary">
                <div class="card-body">
                  <h5 class="card-title"><b>About CovidCollaboration<hr class = "lined"></b></h5>
                  <p class="card-text">
                    In this unprecendented time, COVID has unassailably had a huge impact, with over 30 million cases
                    and 900 thousand deaths in total. From personal experience, as well as hearing the perspectives of others,
                    COVID has impacted ourselves and our loved ones in some shape or form. I wanted to create CovidCollaboration 
                    as a platform for people to connect, empathize, assist one another, and let each other know that we are not alone in this battle. Moreover, I wanted to bring more awareness
                    and educate as many people possible.

                    <br>
                    <br>

                        Furthermore, with majority of schools opting to stay online, and rightful precautions being taken throughout the community, being in quarantine is inevitably lonely,
                        and I wanted to help as much as possible by pushing a forum, and a chatbot to ensure some form of communication, and unity with one another admist this time.
                        Hang in there, you got this!
                    </p>

                    <div id="picture">
                        <img src ="hands.jpeg">
                    </div>
                </div>
              </div>
        </div>

        <div id = "facilities">
            <div class="card-body">
                <h5 class="card-title"><b>Closest Testing Centers<hr class = "lined"></b></h5>
            </div>
        </div>

        <!-- usage of side bar -->
        <div id="panel">
        </div>

        <div id="location">
        </div>

        <div id="chat">
            <div class="card bg-primary">
                <div class="card-body">
                   <h5 class="card-title"><b>Get assistance right away.<hr class = "lined"></b></h5>
                    <iframe
                        style = "width:100%;"
                        allow="microphone;"
                        height="430"
                        src="https://console.dialogflow.com/api-client/demo/embedded/c77b1c29-41ff-4794-a9a6-b7987e1eb8a1">
                    </iframe>
                </div>
              </div>
        </div>

        <div id="travel">
            <div class="card bg-primary">
                <div class="card-body">
                  <h5 class="card-title"><b>Our Forum<hr class = "lined"></b></h5>
                    <p><iframe style="height: 600px; width:100%;" src="http://covidcollaboration.forumotion.com"></iframe></p>
                </div>
                </div>
            </div>
        </div>

        <div id="contact">
            <div id="content">
                <div class="card bg-white">
                    <div class="card-body">
                        <h5 class="card-title"><b>Further Resources<hr class = "lined"></b></h5>
                            <div id="final">
                                <div class="container"> 
                                    <div class = "row" style="text-align: center;">
                                        <div class="col-md-4">
                                              <button id = "button1" type="button" class="btn" data-toggle="modal" onclick="location.href = 'https://www.worldometers.info/coronavirus/';">
                                                      <div class = "outerPic">
                                                          <div class="innerPic">COVID Statistics</div>
                                                      </div>
                                              </button>
                                          </div> 
                  
                                          <div class="col-md-4">
                                            <button  id = "button2" type="button" class="btn" data-toggle="modal" onclick="location.href = 'https://www.cbsnews.com/live-updates/president-trump-covid-19-positive-test-latest-news-2020-10-04/';">
                                                  <div class = "outerPic">
                                                      <div class="innerPic">COVID Updates</div>
                                                  </div>
                                              </button>
                                          </div>

                                          <div class="col-md-4">
                                            <button id = "button3" type="button" class="btn" data-toggle="modal" onclick="location.href = 'https://www.doctorswithoutborders.org/covid19?source=ADD200U0U03&utm_source=google&utm_medium=cpc&utm_campaign=googlegrant&utm_content=nonbrand&utm_term=covid&gclid=EAIaIQobChMIm66x_MKb7AIVForICh2RWgtgEAAYAyAAEgIjbPD_BwE';">
                                                  <div class = "outerPic">
                                                      <div class="innerPic">COVID Facts</div>
                                                  </div>
                                              </button>
                                          </div>
                                    </div>
                        </div>
                    </div>
                </div>  
            </div>
        </div>
        

    <div class ="end bg-primary">

        <footer>
        <div class = "logos">
            <a href = "https://www.linkedin.com/in/kevin-mo-98582b1a6/" target="_blank"> 
            <i class="fab fa-linkedin" title = "Linkedin"></i></a> 
            &nbsp;
            &nbsp;
            &nbsp;

        <a href = "https://github.com/mmKevin-19" target="_blank"> 
            <i class="fab fa-github xs" title = "Github"></i></a>
            &nbsp;
            &nbsp;
            &nbsp;

            <a href = "mailto: kevinmo@princeton.edu"> 
            <i class="fas fa-envelope" title = "Email"></i>
            </a>
        </div>
        </div>
        </footer>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script>
        $(window).scroll(function() {
             $('nav').toggleClass('scrolled', $(this).scrollTop() > 50);
        });
    </script>

    <script>
        $(document).ready(function(){
            $("a").on('click', function(event) {
            
                if (this.hash !== "") {
                event.preventDefault();
            
                var hash = this.hash;
            

                $('html, body').animate({
                    scrollTop: $(hash).offset().top - 100
                }, 750) 
                // function(){
                //     window.location.hash = hash;
                //     // $('html').animate({ 'scrollTop': scrollToPosition }, 0);
                // });
                } 
            });
        });
    </script>

    <script>

        // credits to Google Map api
        let pos;
        let map;
        let bounds;
        let infoWindow;
        let currentInfoWindow;
        let service;
        let infoPane;
        function initMap() {

        // Initialize variables
        bounds = new google.maps.LatLngBounds();
        infoWindow = new google.maps.InfoWindow;
        currentInfoWindow = infoWindow;
        infoPane = document.getElementById('panel');

        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(position => {
            pos = {
                lat: position.coords.latitude,
                lng: position.coords.longitude
            };
            map = new google.maps.Map(document.getElementById('location'), {
                center: pos,
                zoom: 15
            });
            bounds.extend(pos);

            infoWindow.setPosition(pos);
            infoWindow.setContent('Location found.');
            infoWindow.open(map);
            map.setCenter(pos);

            getNearbyPlaces(pos);
            }, () => {
            handleLocationError(true, infoWindow);
            });
        } else {
            handleLocationError(false, infoWindow);
        }
        }

        function handleLocationError(browserHasGeolocation, infoWindow) {
        // Set default location to Sydney, Australia
        pos = { lat: 38.856, lng: 151.215 };
        map = new google.maps.Map(document.getElementById('location'), {
            center: pos,
            zoom: 15
        });

        infoWindow.setPosition(pos);
        infoWindow.setContent(browserHasGeolocation ?
            'Geolocation permissions denied. Using default location.' :
            'Error: Your browser doesn\'t support geolocation.');
        infoWindow.open(map);
        currentInfoWindow = infoWindow;

        // nearby search
        getNearbyPlaces(pos);
        }

        // Perform a Places Nearby Search Request
        function getNearbyPlaces(position) {
        let request = {
            location: position,
            rankBy: google.maps.places.RankBy.DISTANCE,
            keyword: 'nearest places to get tested for covid'
        };

        service = new google.maps.places.PlacesService(map);
        service.nearbySearch(request, nearbyCallback);
        }

        function nearbyCallback(results, status) {
        if (status == google.maps.places.PlacesServiceStatus.OK) {
            createMarkers(results);
        }
        }

        function createMarkers(places) {
        places.forEach(place => {
            let marker = new google.maps.Marker({
            position: place.geometry.location,
            map: map,
            title: place.name
            });

            google.maps.event.addListener(marker, 'click', () => {
            let request = {
                placeId: place.place_id,
                fields: ['name', 'formatted_address', 'geometry', 'rating',
                'website', 'photos']
            };

            service.getDetails(request, (placeResult, status) => {
                showDetails(placeResult, marker, status)
            });
            });

            // extend bounds
            bounds.extend(place.geometry.location);
        });

        map.fitBounds(bounds);
        }

        // infowindow
        function showDetails(placeResult, marker, status) {
        if (status == google.maps.places.PlacesServiceStatus.OK) {
            let placeInfowindow = new google.maps.InfoWindow();
            let rating = "None";
            if (placeResult.rating) rating = placeResult.rating;
            placeInfowindow.setContent('<div><strong>' + placeResult.name +
            '</strong><br>' + 'Rating: ' + rating + '</div>');
            placeInfowindow.open(marker.map, marker);
            currentInfoWindow.close();
            currentInfoWindow = placeInfowindow;
            showPanel(placeResult);
        } else {
            console.log('showDetails failed: ' + status);
        }
        }

        function showPanel(placeResult) {
        // check
        if (infoPane.classList.contains("open")) {
            infoPane.classList.remove("open");
        }

        while (infoPane.lastChild) {
            infoPane.removeChild(infoPane.lastChild);
        }

        // shows place details
        if (placeResult.photos) {
            let firstPhoto = placeResult.photos[0];
            let photo = document.createElement('img');
            photo.classList.add('hero');
            photo.src = firstPhoto.getUrl();
            infoPane.appendChild(photo);
        }

        let name = document.createElement('h1');
        name.classList.add('place');
        name.textContent = placeResult.name;
        infoPane.appendChild(name);

        if (placeResult.rating) {
            let rating = document.createElement('p');
            rating.classList.add('details');
            rating.textContent = `Rating: ${placeResult.rating} \u272e`;
            infoPane.appendChild(rating);
        }
        
        let address = document.createElement('p');
        address.classList.add('details');
        address.textContent = placeResult.formatted_address;
        infoPane.appendChild(address);

        if (placeResult.website) {
            let websitePara = document.createElement('p');
            let websiteLink = document.createElement('a');
            let websiteUrl = document.createTextNode(placeResult.website);
            websiteLink.appendChild(websiteUrl);
            websiteLink.title = placeResult.website;
            websiteLink.href = placeResult.website;
            websitePara.appendChild(websiteLink);
            infoPane.appendChild(websitePara);
        }

        infoPane.classList.add("open");
        }
    </script>

    <!-- load google maps api -->
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAOBpQyN12Tgwqo1AoI4lh0OQAgSpCug5o&libraries=places&callback=initMap">
    </script>
  </body>
</html>